<!--

This file assumes that settings_plugin_octostreamcontrol is bound to OctoStreamControlViewModel

-->
<h3>OctoStream Control Settings</h3>

<p>
  Configure settings for each stream individually here.  See below 
  for a description of each setting.
</p>

<div id="settings_plugin_octostreamcontrol" class="settings-section">
  <div class="stream-list" data-bind="foreach: settings.streams">
    <table class="stream-entry">
      <tr>
        <th>Stream Name</th>
        <td>
          <input type="text" data-bind="value: name" placeholder="Camera" />
        </td>
      </tr>
      <tr>
        <th>WebRTC URL</th>
        <td>
          <input type="text" data-bind="value: webrtc_url" placeholder="WebRTC URL" />
        </td>
      </tr>
      <tr>
        <th>RTSP URL</th>
        <td>
          <input type="text" data-bind="value: rtsp_url" placeholder="RTSP URL" />
        </td>
      </tr>
      <tr>
        <th>FFmpeg Command</th>
        <td>
          <input type="text" data-bind="value: ffmpeg_cmd" placeholder="FFmpeg Command" />
        </td>
      </tr>
      <tr>
        <th>Width</th>
        <td>
          <input type="text" data-bind="value: width" placeholder="Width" />
        </td>
      </tr>
      <tr>
        <th>Height</th>
        <td>
          <input type="text" data-bind="value: height" placeholder="Height" />
        </td>
      </tr>
      <tr>
        <th>Video Directory</th>
        <td>
          <input type="text" data-bind="value: video_dir" placeholder="Video Directory" />
        </td>
      </tr>
      <tr>
        <th>Enabled</th>
        <td>
          <input type="checkbox" data-bind="checked: enabled" />
        </td>
      </tr>
      <tr>
        <th>Upload to YouTube</th>
        <td>
          <input type="checkbox" data-bind="checked: upload_to_youtube" />
        </td>
      </tr>
      <tr>
        <td colspan="2">
          <button data-bind="click: $parent.removeStream">Remove</button>
        </td>
      </tr>
    </table>
  </div>
  
  <button data-bind="click: addStream">Add Stream</button><br/>

  <h4>YouTube Upload Settings</h4>
  <p>Configure global YouTube upload settings. Each stream can be individually enabled for upload.</p>

  <table class="youtube-settings" data-bind="with: settings.youtube">
    <tr>
      <th>Enable YouTube Uploads</th>
      <td>
        <input type="checkbox" data-bind="checked: enabled" />
      </td>
    </tr>
    <tr>
      <th>Client Secrets File</th>
      <td>
        <input type="text" data-bind="value: client_secrets_file" placeholder="/path/to/client_secrets.json" style="width: 100%;" />
      </td>
    </tr>
    <tr>
      <th>Credentials File</th>
      <td>
        <input type="text" data-bind="value: credentials_file" placeholder="/path/to/credentials.pickle" style="width: 100%;" />
      </td>
    </tr>
    <tr>
      <th>Default Video Title</th>
      <td>
        <input type="text" data-bind="value: default_title" placeholder="3D Print Timelapse - {job_name}" style="width: 100%;" />
      </td>
    </tr>
    <tr>
      <th>Default Description</th>
      <td>
        <textarea data-bind="value: default_description" placeholder="3D print recorded on {date}" style="width: 100%; height: 60px;"></textarea>
      </td>
    </tr>
    <tr>
      <th>Default Category ID</th>
      <td>
        <input type="text" data-bind="value: default_category" placeholder="22" />
      </td>
    </tr>
    <tr>
      <th>Default Privacy</th>
      <td>
        <select data-bind="value: default_privacy">
          <option value="public">Public</option>
          <option value="unlisted">Unlisted</option>
          <option value="private">Private</option>
        </select>
      </td>
    </tr>
    <tr>
      <th>Default Tags (comma-separated)</th>
      <td>
        <input type="text" data-bind="value: default_tags" placeholder="3d printing, timelapse, octoprint" style="width: 100%;" />
      </td>
    </tr>
    <tr>
      <th>Authorization</th>
      <td>
        <button class="btn btn-primary" data-bind="click: $parent.authorizeYouTube">
          <i class="fa fa-key"></i> Authorize YouTube
        </button>
        <br/>
        <small>Click to start OAuth authorization flow. A browser window will open.</small>
      </td>
    </tr>
  </table>

  <div class="stream-settings-info">
    <label for="stream_url">Stream URL</label>
    <small>
      The URL for your web-accessible stream.  This should return HTML for rendering video.
      For example, if you are using a WebRTC stream, it might look like:
      <code>http://localhost:8889/mystream</code>.
    </small>
  </div>
  
  <!-- same format for ffmpeg_cmd-->
  <div class="stream-settings-info">
    <label for="ffmpeg_cmd">FFmpeg Command</label>
    <small>
      The command to run FFmpeg for recording. This should be a valid FFmpeg command, but without the input or output, which will be filled in by this plugin.
      Ensure that the command is correct and that FFmpeg is installed on your system.
    </small>
  </div>
  
  <!-- same format for rstp_url-->
  <div class="stream-settings-info">
    <label for="rtsp_url">RTSP URL</label>
    <small>
      The URL for your RTSP stream. This is used for recording.
      For example, it might look like: <code>rtsp://localhost:8554/mystream</code>.
      Ensure that your RTSP server is configured correctly to serve this stream.
    </small>
  </div>
  
  <!-- resolution & video_dir the same -->
  <div class="stream-settings-info">
    <label for="video_dir">Video Directory</label>
    <small>
      The directory where recorded videos will be saved. Ensure that the OctoPrint user has write permissions to this directory.
      For example, it might look like: <code>/home/pi/videos</code>.
    </small>
  </div>
  
  <!-- do the same for resolution -->
  <div class="stream-settings-info">
    <label for="resolution">Resolution (Width, Height)</label>
    <small>
      The resolution for the video stream.
      Ensure that this matches the capabilities of your camera and stream.
    </small>
  </div>

  <div class="stream-settings-info">
    <label for="youtube_settings">YouTube Upload Settings</label>
    <small>
      To enable YouTube uploads, you need to:
      <ol>
        <li>Create a Google Cloud project and enable the YouTube Data API v3</li>
        <li>Create OAuth 2.0 credentials (Desktop app type) and download the client secrets JSON file</li>
        <li>Set the path to your client secrets file in "Client Secrets File"</li>
        <li>Set the path where credentials will be saved in "Credentials File"</li>
        <li>Run the OAuth flow once to authorize (see plugin documentation)</li>
        <li>Enable YouTube uploads globally, then enable per-stream in each stream's settings</li>
      </ol>
      Available template variables for title/description: <code>{job_name}</code>, <code>{stream_name}</code>, <code>{date}</code>
      <br/>
      Category IDs: 22=People & Blogs, 28=Science & Technology, 24=Entertainment, etc.
    </small>
  </div>
</div>