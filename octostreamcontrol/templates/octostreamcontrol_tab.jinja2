<div id="tab_plugin_octostreamcontrol">
  <h3>Live WebRTC Stream</h3>

  <!-- Global recording controls -->
  <div style="margin-bottom: 20px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; background-color: #f9f9f9;">
    <h4>Recording Controls</h4>
    <p>Control recording for all enabled streams:</p>
    <div style="margin-bottom: 10px;">
      <button data-bind="click: startRecording, enable: !isRecording()" class="btn btn-primary">
        <span data-bind="visible: !isRecording()">Start Recording All Streams</span>
        <span data-bind="visible: isRecording()">Recording in Progress...</span>
      </button>
      <button data-bind="click: stopRecording, enable: isRecording()" class="btn btn-danger">Stop Recording All Streams</button>
    </div>
    <div data-bind="visible: isRecording()" style="font-size: 12px; color: #666;">
      <i class="fa fa-circle" style="color: #d9534f; animation: blink 1s infinite;"></i>
      Currently recording <span data-bind="text: activeStreams"></span> stream(s)
    </div>
    <style>
      @keyframes blink {
        0%, 50% { opacity: 1; }
        51%, 100% { opacity: 0.3; }
      }
    </style>
  </div>

  <!-- YouTube Upload Controls -->
  <div data-bind="if: settings.youtube.enabled" style="margin-bottom: 20px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; background-color: #f0f8ff;">
    <h4>YouTube Upload</h4>
    <p>Upload recorded videos to YouTube:</p>
    <div style="margin-bottom: 10px;">
      <button data-bind="click: retryYouTubeUpload" class="btn btn-success">
        <i class="fa fa-upload"></i> Upload Videos to YouTube
      </button>
    </div>
    <small style="color: #666;">Select from the 10 most recent videos in your video directories.</small>
  </div>

  <!-- Stream display -->
  <div data-bind="foreach: streams">
    <div style="margin-bottom: 20px; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">
      <h4 data-bind="text: name"></h4>
      <p>
        <strong>WebRTC URL:</strong> <span data-bind="text: webrtc_url"></span><br/>
        <strong>RTSP URL:</strong> <span data-bind="text: rtsp_url"></span><br/>
        <strong>FFmpeg Command:</strong> <span data-bind="text: ffmpeg_cmd"></span><br/>
        <strong>Resolution:</strong> <span data-bind="text: width"></span> x <span data-bind="text: height"></span><br/>
        <strong>Video Directory:</strong> <span data-bind="text: video_dir"></span><br/>
        <strong>Enabled:</strong> <span data-bind="text: enabled ? 'Yes' : 'No'"></span>
      </p>
      <iframe data-bind="attr: {
        src: webrtc_url,
        width: width,
        height: height
      }"
      frameborder="0" allow="autoplay">
      </iframe>
    </div>
  </div>
</div>
